# Phase 1: 백엔드 + 데이터 셋업

---

## 작업 일시

- **날짜**: 2026-02-27 (목)
- **시간**: 09:53 ~ 10:15 KST

---

## 1. DB 스키마 생성 (Supabase SQL Editor)

### 생성된 테이블 (8개)

| 테이블 | 용도 |
|--------|------|
| brands | 브랜드 (가짜 4개) |
| products | 영양제 제품 (embedding 컬럼 포함) |
| ingredients | 성분 (embedding 컬럼 포함) |
| product_ingredients | 제품-성분 매핑 (함량) |
| symptoms | 증상/효능 카테고리 |
| ingredient_symptoms | 성분-증상 매핑 (관련도) |
| bot_logs | AI 봇 접근 로그 |
| click_logs | 어필리에이트 클릭 추적 |

### RLS 정책

- 전체 테이블 RLS 활성화
- brands, products, ingredients, product_ingredients, symptoms, ingredient_symptoms: 공개 읽기 허용
- bot_logs, click_logs: 서버 쓰기만 허용

### 스크립트

- `scripts/schema.sql` — DDL (Supabase SQL Editor에서 수동 실행)

---

## 2. 목 데이터 시딩

### 시딩된 데이터

| 테이블 | 건수 | 내용 |
|--------|------|------|
| brands | 4 | VitaCore Labs, NutriZen, BioPlus Health, MediPure Labs |
| ingredients | 8 | B1, B6, B12, 엽산, 비오틴, B5, 마그네슘, D3 |
| products | 5 | B-Complex 4종 + 마그네슘 1종 |
| product_ingredients | 16 | 제품-성분 함량 매핑 |
| symptoms | 5 | 피로, 수면, 집중력, 면역, 스트레스 |
| ingredient_symptoms | 14 | 성분-증상 관련도 매핑 |

### 스크립트

- `scripts/seed-data.ts` — `deno run --allow-net --allow-env --allow-read scripts/seed-data.ts`

---

## 3. 조회 테스트 (성공)

- 브랜드 목록 조회: OK
- 제품 + 브랜드 JOIN: OK
- 제품 상세 + 성분 정보: OK
- 증상별 추천 (피로 → 관련 성분): OK
- anon key로 조회 가능 확인: OK

### 스크립트

- `scripts/check-db.ts` — 연결 확인
- `scripts/check-tables.ts` — 테이블 존재 확인
- `scripts/test-query.ts` — 데이터 조회 테스트

---

## 4. 다음 단계

- [ ] Phase 2: Fresh API 라우트 구현 (routes/api/)
- [ ] Phase 2: SSR 페이지 + JSON-LD + 시맨틱 HTML
